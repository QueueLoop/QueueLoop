 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/index.html b/index.html
index deb6af1de117bc12cf4615c0874e676be998a6b3..e640a2b7a7da22e14b2dbc0d61930b66aa4af278 100644
--- a/index.html
+++ b/index.html
@@ -79,97 +79,50 @@
           <!-- Preferences: completely optional -->
           <div class="adv">
             <div class="row">
               <select name="farm_size">
                 <option value="">Farm size (optional)</option>
                 <option value="1-2">1‚Äì2</option>
                 <option value="3-5">3‚Äì5</option>
                 <option value="6-10">6‚Äì10</option>
                 <option value="10+">10+</option>
               </select>
 
               <div class="chips" aria-label="Printers">
                 <label class="chip"><input type="checkbox" name="printer[]" value="Bambu">Bambu</label>
                 <label class="chip"><input type="checkbox" name="printer[]" value="Prusa">Prusa</label>
                 <label class="chip"><input type="checkbox" name="printer[]" value="Creality">Creality</label>
                 <label class="chip"><input type="checkbox" name="printer[]" value="Voron">Voron</label>
                 <label class="chip"><input type="checkbox" name="printer[]" value="Other">Other</label>
               </div>
             </div>
 
             <textarea name="pain" rows="2" placeholder="Biggest pain point right now? (optional)"></textarea>
             <label class="inline"><input type="checkbox" name="pilot_interest" value="yes"> Apply for pilot</label>
           </div>
         </form>
 
-        <script>
-          // UTM + source/src capture
-          (function(){
-            const params = new URLSearchParams(location.search);
-
-            function setHidden(id, val){
-              const el = document.getElementById(id);
-              if (el) el.value = val || '';
-            }
-
-            // Accept either ?src= or ?source=
-            const srcParam = params.get('src') || params.get('source') || '';
-
-            // Fill UTMs; if utm_source missing, fall back to src/source
-            setHidden('utm_source',   params.get('utm_source')   || srcParam);
-            setHidden('utm_medium',   params.get('utm_medium')   || '');
-            setHidden('utm_campaign', params.get('utm_campaign') || '');
-            setHidden('utm_content',  params.get('utm_content')  || '');
-
-            // Keep a simple "source" for Formspree readability
-            setHidden('source', srcParam);
-          })();
-
-          // Custom redirect after submit (Formspree fetch)
-          document.getElementById("queue-form").addEventListener("submit", async function(e) {
-            e.preventDefault();
-            const form = e.target;
-            const data = new FormData(form);
-
-            try {
-              const response = await fetch(form.action, {
-                method: form.method,
-                body: data,
-                headers: { 'Accept': 'application/json' }
-              });
-
-              if (response.ok) {
-                window.location.href = "/thank-you.html";
-              } else {
-                alert("Oops, something went wrong. Please try again.");
-              }
-            } catch (error) {
-              alert("Network error. Please try again.");
-            }
-          });
-        </script>
-
         
         <p class="mini">By joining, you agree to be contacted about early access and product updates.</p>
         <div class="badges">
           <span>üîí LAN control available</span>
           <span>‚öôÔ∏è AMS-aware workflows</span>
           <span>üöÄ Built for TikTok & Etsy sellers</span>
           <span>üß† Failure-aware modes (optional)</span>
         </div>
       </div>
       <div class="hero-card">
         <img src="images/ui.png" alt="QueueLoop demo UI" class="ui-demo">
         <p class="mini center">Demo UI ‚Äî final product may differ.</p>
       </div>
     </div>
   </section>
 
   <!-- FEATURES -->
   <section id="features" class="section">
     <div class="container">
       <h2>Stop babysitting your 3D printer.</h2>
       <p class="sub">
         Turn orders into a live print queue with AMS-aware color mapping, batching, and optional auto-eject.
       </p>
       <div class="grid-3">
         <div class="card">
diff --git a/index.html b/index.html
index deb6af1de117bc12cf4615c0874e676be998a6b3..e640a2b7a7da22e14b2dbc0d61930b66aa4af278 100644
--- a/index.html
+++ b/index.html
@@ -292,27 +245,85 @@
 
   <!-- FINAL CTA -->
   <section class="cta-final">
     <div class="container">
       <h2>Ready to stop babysitting prints?</h2>
       <div class="cta">
         <a href="#join" class="btn-link">Join the Waitlist</a>
       </div>
       <p class="mini">
         Questions? <a href="mailto:hello@queueloop.com">contact@queueloop.com</a> ¬∑
         <a href="https://discord.gg/YOUR_INVITE" target="_blank" rel="noopener">Join our Discord</a>
       </p>
     </div>
   </section>
 </main>
 
 <footer class="footer">
   <div class="container footer-row">
     <div>¬© <span id="y"></span> QueueLoop ‚Äî Automation for 3D printing</div>
     <div class="muted">Not affiliated with any printer or marketplace brand.</div>
   </div>
 </footer>
 <script>
   document.getElementById('y').textContent = new Date().getFullYear();
 </script>
+
+<script>
+  document.addEventListener('DOMContentLoaded', function () {
+    console.log('[Init] DOMContentLoaded');
+
+    // --- Populate hidden fields from URL params ---
+    const params = new URLSearchParams(window.location.search);
+    const getParam = (name) => params.get(name) || '';
+    const srcParam = getParam('src') || getParam('source');
+
+    const fields = {
+      utm_source:   getParam('utm_source') || srcParam,
+      utm_medium:   getParam('utm_medium'),
+      utm_campaign: getParam('utm_campaign'),
+      utm_content:  getParam('utm_content'),
+      source:       srcParam
+    };
+
+    Object.entries(fields).forEach(([id, value]) => {
+      const el = document.getElementById(id);
+      if (el) {
+        el.value = value;
+        console.log(`[UTM] ${id} = "${value}"`);
+      } else {
+        console.warn(`[UTM] Missing field: ${id}`);
+      }
+    });
+
+    // --- Intercept submit and send to Formspree ---
+    const form = document.getElementById('queue-form');
+    if (!form) {
+      console.error('Form not found: #queue-form');
+      return;
+    }
+
+    form.addEventListener('submit', async function (e) {
+      e.preventDefault();
+      console.log('[Submit] sending form');
+      try {
+        const response = await fetch(form.action, {
+          method: form.method || 'POST',
+          body: new FormData(form),
+          headers: { 'Accept': 'application/json' }
+        });
+        console.log('[Submit] response status', response.status);
+        if (response.ok) {
+          window.location.assign('/thank-you.html');
+        } else {
+          console.error('[Submit] server error', response.status);
+          alert('Oops, something went wrong. Please try again.');
+        }
+      } catch (err) {
+        console.error('[Submit] network error', err);
+        alert('Network error. Please try again.');
+      }
+    });
+  });
+</script>
 </body>
 </html>
 
EOF
)
